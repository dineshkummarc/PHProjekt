/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._hasResource["dijit.form.Textarea"]||(dojo._hasResource["dijit.form.Textarea"]=!0,dojo.provide("dijit.form.Textarea"),dojo.require("dijit.form.SimpleTextarea"),dojo.declare("dijit.form.Textarea",dijit.form.SimpleTextarea,{baseClass:"dijitTextBox dijitTextArea dijitExpandingTextArea",cols:"",_previousNewlines:0,_strictMode:dojo.doc.compatMode!="BackCompat",_getHeight:function(a){var b=a.scrollHeight;b+=dojo.isIE?a.offsetHeight-a.clientHeight-(dojo.isIE<8&&this._strictMode?dojo._getPadBorderExtents(a).h:
0):dojo.isMoz?a.offsetHeight-a.clientHeight:dojo.isWebKit?dojo._getBorderExtents(a).h:dojo._getPadBorderExtents(a).h;return b},_estimateHeight:function(a){a.style.maxHeight="";a.style.height="auto";a.rows=(a.value.match(/\n/g)||[]).length+1},_needsHelpShrinking:dojo.isMoz||dojo.isWebKit,_onInput:function(){this.inherited(arguments);if(!this._busyResizing){this._busyResizing=!0;var a=this.textbox;if(a.scrollHeight&&a.offsetHeight&&a.clientHeight){var b=this._getHeight(a)+"px";if(a.style.height!=b)a.style.maxHeight=
a.style.height=b;if(this._needsHelpShrinking)this._setTimeoutHandle&&clearTimeout(this._setTimeoutHandle),this._setTimeoutHandle=setTimeout(dojo.hitch(this,"_shrink"),0)}else this._estimateHeight(a);this._busyResizing=!1}},_busyResizing:!1,_shrink:function(){this._setTimeoutHandle=null;if(this._needsHelpShrinking&&!this._busyResizing){this._busyResizing=!0;var a=this.textbox,b=!1;if(a.value=="")a.value=" ",b=!0;var d=a.scrollHeight;if(d){var e=a.style.paddingBottom,c=dojo._getPadExtents(a),c=c.h-
c.t;a.style.paddingBottom=c+1+"px";var f=this._getHeight(a)-1+"px";if(a.style.maxHeight!=f)a.style.paddingBottom=c+d+"px",a.scrollTop=0,a.style.maxHeight=this._getHeight(a)-d+"px";a.style.paddingBottom=e}else this._estimateHeight(a);if(b)a.value="";this._busyResizing=!1}},resize:function(){this._onInput()},_setValueAttr:function(){this.inherited(arguments);this.resize()},buildRendering:function(){this.inherited(arguments);dojo.style(this.textbox,{overflowY:"hidden",overflowX:"auto",boxSizing:"border-box",
MsBoxSizing:"border-box",WebkitBoxSizing:"border-box",MozBoxSizing:"border-box"})},postCreate:function(){this.inherited(arguments);this.connect(this.textbox,"onscroll","_onInput");this.connect(this.textbox,"onresize","_onInput");this.connect(this.textbox,"onfocus","_onInput");this._setTimeoutHandle=setTimeout(dojo.hitch(this,"resize"),0)},uninitialize:function(){this._setTimeoutHandle&&clearTimeout(this._setTimeoutHandle);this.inherited(arguments)}}));