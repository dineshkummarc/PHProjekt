/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["dojox.gfx3d.matrix"])dojo._hasResource["dojox.gfx3d.matrix"]=!0,dojo.provide("dojox.gfx3d.matrix"),dojox.gfx3d.matrix._degToRad=function(a){return Math.PI*a/180},dojox.gfx3d.matrix._radToDeg=function(a){return a/Math.PI*180},dojox.gfx3d.matrix.Matrix3D=function(a){if(a)if(typeof a=="number")this.xx=this.yy=this.zz=a;else if(a instanceof Array){if(a.length>0){for(var b=dojox.gfx3d.matrix.normalize(a[0]),e=1;e<a.length;++e){var c=b,d=dojox.gfx3d.matrix.normalize(a[e]),b=new dojox.gfx3d.matrix.Matrix3D;
b.xx=c.xx*d.xx+c.xy*d.yx+c.xz*d.zx;b.xy=c.xx*d.xy+c.xy*d.yy+c.xz*d.zy;b.xz=c.xx*d.xz+c.xy*d.yz+c.xz*d.zz;b.yx=c.yx*d.xx+c.yy*d.yx+c.yz*d.zx;b.yy=c.yx*d.xy+c.yy*d.yy+c.yz*d.zy;b.yz=c.yx*d.xz+c.yy*d.yz+c.yz*d.zz;b.zx=c.zx*d.xx+c.zy*d.yx+c.zz*d.zx;b.zy=c.zx*d.xy+c.zy*d.yy+c.zz*d.zy;b.zz=c.zx*d.xz+c.zy*d.yz+c.zz*d.zz;b.dx=c.xx*d.dx+c.xy*d.dy+c.xz*d.dz+c.dx;b.dy=c.yx*d.dx+c.yy*d.dy+c.yz*d.dz+c.dy;b.dz=c.zx*d.dx+c.zy*d.dy+c.zz*d.dz+c.dz}dojo.mixin(this,b)}}else dojo.mixin(this,a)},dojo.extend(dojox.gfx3d.matrix.Matrix3D,
{xx:1,xy:0,xz:0,yx:0,yy:1,yz:0,zx:0,zy:0,zz:1,dx:0,dy:0,dz:0}),dojo.mixin(dojox.gfx3d.matrix,{identity:new dojox.gfx3d.matrix.Matrix3D,translate:function(a,b,e){return arguments.length>1?new dojox.gfx3d.matrix.Matrix3D({dx:a,dy:b,dz:e}):new dojox.gfx3d.matrix.Matrix3D({dx:a.x,dy:a.y,dz:a.z})},scale:function(a,b,e){return arguments.length>1?new dojox.gfx3d.matrix.Matrix3D({xx:a,yy:b,zz:e}):typeof a=="number"?new dojox.gfx3d.matrix.Matrix3D({xx:a,yy:a,zz:a}):new dojox.gfx3d.matrix.Matrix3D({xx:a.x,
yy:a.y,zz:a.z})},rotateX:function(a){var b=Math.cos(a),a=Math.sin(a);return new dojox.gfx3d.matrix.Matrix3D({yy:b,yz:-a,zy:a,zz:b})},rotateXg:function(a){return dojox.gfx3d.matrix.rotateX(dojox.gfx3d.matrix._degToRad(a))},rotateY:function(a){var b=Math.cos(a),a=Math.sin(a);return new dojox.gfx3d.matrix.Matrix3D({xx:b,xz:a,zx:-a,zz:b})},rotateYg:function(a){return dojox.gfx3d.matrix.rotateY(dojox.gfx3d.matrix._degToRad(a))},rotateZ:function(a){var b=Math.cos(a),a=Math.sin(a);return new dojox.gfx3d.matrix.Matrix3D({xx:b,
xy:-a,yx:a,yy:b})},rotateZg:function(a){return dojox.gfx3d.matrix.rotateZ(dojox.gfx3d.matrix._degToRad(a))},cameraTranslate:function(a,b,e){return arguments.length>1?new dojox.gfx3d.matrix.Matrix3D({dx:-a,dy:-b,dz:-e}):new dojox.gfx3d.matrix.Matrix3D({dx:-a.x,dy:-a.y,dz:-a.z})},cameraRotateX:function(a){var b=Math.cos(-a),a=Math.sin(-a);return new dojox.gfx3d.matrix.Matrix3D({yy:b,yz:-a,zy:a,zz:b})},cameraRotateXg:function(a){return dojox.gfx3d.matrix.rotateX(dojox.gfx3d.matrix._degToRad(a))},cameraRotateY:function(a){var b=
Math.cos(-a),a=Math.sin(-a);return new dojox.gfx3d.matrix.Matrix3D({xx:b,xz:a,zx:-a,zz:b})},cameraRotateYg:function(a){return dojox.gfx3d.matrix.rotateY(dojox.gfx3d.matrix._degToRad(a))},cameraRotateZ:function(a){var b=Math.cos(-a),a=Math.sin(-a);return new dojox.gfx3d.matrix.Matrix3D({xx:b,xy:-a,yx:a,yy:b})},cameraRotateZg:function(a){return dojox.gfx3d.matrix.rotateZ(dojox.gfx3d.matrix._degToRad(a))},normalize:function(a){return a instanceof dojox.gfx3d.matrix.Matrix3D?a:new dojox.gfx3d.matrix.Matrix3D(a)},
clone:function(a){var b=new dojox.gfx3d.matrix.Matrix3D,e;for(e in a)typeof a[e]=="number"&&typeof b[e]=="number"&&b[e]!=a[e]&&(b[e]=a[e]);return b},invert:function(a){var a=dojox.gfx3d.matrix.normalize(a),b=a.xx*a.yy*a.zz+a.xy*a.yz*a.zx+a.xz*a.yx*a.zy-a.xx*a.yz*a.zy-a.xy*a.yx*a.zz-a.xz*a.yy*a.zx;return new dojox.gfx3d.matrix.Matrix3D({xx:(a.yy*a.zz-a.yz*a.zy)/b,xy:(a.xz*a.zy-a.xy*a.zz)/b,xz:(a.xy*a.yz-a.xz*a.yy)/b,yx:(a.yz*a.zx-a.yx*a.zz)/b,yy:(a.xx*a.zz-a.xz*a.zx)/b,yz:(a.xz*a.yx-a.xx*a.yz)/b,zx:(a.yx*
a.zy-a.yy*a.zx)/b,zy:(a.xy*a.zx-a.xx*a.zy)/b,zz:(a.xx*a.yy-a.xy*a.yx)/b,dx:-1*(a.xy*a.yz*a.dz+a.xz*a.dy*a.zy+a.dx*a.yy*a.zz-a.xy*a.dy*a.zz-a.xz*a.yy*a.dz-a.dx*a.yz*a.zy)/b,dy:(a.xx*a.yz*a.dz+a.xz*a.dy*a.zx+a.dx*a.yx*a.zz-a.xx*a.dy*a.zz-a.xz*a.yx*a.dz-a.dx*a.yz*a.zx)/b,dz:-1*(a.xx*a.yy*a.dz+a.xy*a.dy*a.zx+a.dx*a.yx*a.zy-a.xx*a.dy*a.zy-a.xy*a.yx*a.dz-a.dx*a.yy*a.zx)/b})},_multiplyPoint:function(a,b,e,c){return{x:a.xx*b+a.xy*e+a.xz*c+a.dx,y:a.yx*b+a.yy*e+a.yz*c+a.dy,z:a.zx*b+a.zy*e+a.zz*c+a.dz}},multiplyPoint:function(a,
b,e,c){a=dojox.gfx3d.matrix.normalize(a);return typeof b=="number"&&typeof e=="number"&&typeof c=="number"?dojox.gfx3d.matrix._multiplyPoint(a,b,e,c):dojox.gfx3d.matrix._multiplyPoint(a,b.x,b.y,b.z)},multiply:function(a){for(var b=dojox.gfx3d.matrix.normalize(a),e=1;e<arguments.length;++e){var c=b,d=dojox.gfx3d.matrix.normalize(arguments[e]),b=new dojox.gfx3d.matrix.Matrix3D;b.xx=c.xx*d.xx+c.xy*d.yx+c.xz*d.zx;b.xy=c.xx*d.xy+c.xy*d.yy+c.xz*d.zy;b.xz=c.xx*d.xz+c.xy*d.yz+c.xz*d.zz;b.yx=c.yx*d.xx+c.yy*
d.yx+c.yz*d.zx;b.yy=c.yx*d.xy+c.yy*d.yy+c.yz*d.zy;b.yz=c.yx*d.xz+c.yy*d.yz+c.yz*d.zz;b.zx=c.zx*d.xx+c.zy*d.yx+c.zz*d.zx;b.zy=c.zx*d.xy+c.zy*d.yy+c.zz*d.zy;b.zz=c.zx*d.xz+c.zy*d.yz+c.zz*d.zz;b.dx=c.xx*d.dx+c.xy*d.dy+c.xz*d.dz+c.dx;b.dy=c.yx*d.dx+c.yy*d.dy+c.yz*d.dz+c.dy;b.dz=c.zx*d.dx+c.zy*d.dy+c.zz*d.dz+c.dz}return b},_project:function(a,b,e,c){return{x:a.xx*b+a.xy*e+a.xz*c+a.dx,y:a.yx*b+a.yy*e+a.yz*c+a.dy,z:a.zx*b+a.zy*e+a.zz*c+a.dz}},project:function(a,b,e,c){a=dojox.gfx3d.matrix.normalize(a);return typeof b==
"number"&&typeof e=="number"&&typeof c=="number"?dojox.gfx3d.matrix._project(a,b,e,c):dojox.gfx3d.matrix._project(a,b.x,b.y,b.z)}}),dojox.gfx3d.Matrix3D=dojox.gfx3d.matrix.Matrix3D;