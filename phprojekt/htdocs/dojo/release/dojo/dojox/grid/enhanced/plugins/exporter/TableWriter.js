/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._hasResource["dojox.grid.enhanced.plugins.exporter.TableWriter"]||(dojo._hasResource["dojox.grid.enhanced.plugins.exporter.TableWriter"]=!0,dojo.provide("dojox.grid.enhanced.plugins.exporter.TableWriter"),dojo.require("dojox.grid.enhanced.plugins.exporter._ExportWriter"),dojox.grid.enhanced.plugins.Exporter.registerWriter("table","dojox.grid.enhanced.plugins.exporter.TableWriter"),dojo.declare("dojox.grid.enhanced.plugins.exporter.TableWriter",dojox.grid.enhanced.plugins.exporter._ExportWriter,
{constructor:function(a){this._viewTables=[];this._tableAttrs=a||{}},_getTableAttrs:function(a){(a=this._tableAttrs[a]||"")&&a[0]!=" "&&(a=" "+a);return a},_getRowClass:function(a){return a.isHeader?" grid_header":[" grid_row grid_row_",a.rowIdx+1,a.rowIdx%2?" grid_even_row":" grid_odd_row"].join("")},_getColumnClass:function(a){a=a.cell.index+a.colOffset+1;return[" grid_column_",a,a%2?" grid_odd_column":" grid_even_column"].join("")},beforeView:function(a){var b=a.viewIdx,c=this._viewTables[b],d,
e=dojo.marginBox(a.view.contentNode).w;if(!c){for(d=c=0;d<b;++d)c+=this._viewTables[d]._width;c=this._viewTables[b]=['<table class="grid_view" style="position: absolute; top: 0; left:',c,'px;"',this._getTableAttrs("table"),">"]}c._width=e;a.isHeader?(b="thead",d=dojo.contentBox(a.view.headerContentNode).h):(b="tbody",d=(d=a.grid.getRowNode(a.rowIdx))?dojo.contentBox(d).h:a.grid.scroller.averageRowHeight);c.push("<",b,' style="height:',d,"px; width:",e,'px;"',' class="',this._getRowClass(a),'"',this._getTableAttrs(b),
">");return!0},afterView:function(a){this._viewTables[a.viewIdx].push(a.isHeader?"</thead>":"</tbody>")},beforeSubrow:function(a){this._viewTables[a.viewIdx].push("<tr",this._getTableAttrs("tr"),">");return!0},afterSubrow:function(a){this._viewTables[a.viewIdx].push("</tr>")},handleCell:function(a){var b=a.cell;if(!(b.hidden||dojo.indexOf(a.spCols,b.index)>=0)){var c=a.isHeader?"th":"td",d=[b.colSpan?' colspan="'+b.colSpan+'"':"",b.rowSpan?' rowspan="'+b.rowSpan+'"':"",' style="width: ',dojo.contentBox(b.getHeaderNode()).w,
'px;"',this._getTableAttrs(c),' class="',this._getColumnClass(a),'"'].join(""),e=this._viewTables[a.viewIdx];e.push("<",c,d,">");a.isHeader?e.push(b.name||b.field):e.push(this._getExportDataForCell(a.rowIdx,a.row,b,a.grid));e.push("</",c,">")}},afterContent:function(){dojo.forEach(this._viewTables,function(a){a.push("</table>")})},toString:function(){return['<div style="position: relative;">',dojo.map(this._viewTables,function(a){return a.join("")}).join(""),"</div>"].join("")}}));