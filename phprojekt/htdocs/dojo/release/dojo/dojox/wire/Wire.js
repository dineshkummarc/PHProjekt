/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._hasResource["dojox.wire.Wire"]||(dojo._hasResource["dojox.wire.Wire"]=!0,dojo.provide("dojox.wire.Wire"),dojo.require("dojox.wire._base"),dojo.declare("dojox.wire.Wire",null,{_wireClass:"dojox.wire.Wire",constructor:function(b){dojo.mixin(this,b);if(this.converter)if(dojo.isString(this.converter)){b=dojo.getObject(this.converter);if(dojo.isFunction(b))try{var a=new b;this.converter=a&&!dojo.isFunction(a.convert)?{convert:b}:a}catch(c){}else if(dojo.isObject(b)&&dojo.isFunction(b.convert))this.converter=
b;if(dojo.isString(this.converter))this.converter=(a=dojox.wire._getClass(this.converter))?new a:void 0}else if(dojo.isFunction(this.converter))this.converter={convert:this.converter}},getValue:function(b){var a=void 0,a=dojox.wire.isWire(this.object)?this.object.getValue(b):this.object||b;if(this.property){var b=this.property.split("."),c;for(c in b){if(!a)return a;a=this._getPropertyValue(a,b[c])}}c=void 0;if(c=this._getValue?this._getValue(a):a)this.type&&(this.type=="string"?c=c.toString():this.type==
"number"?c=parseInt(c,10):this.type=="boolean"?c=c!="false":this.type=="array"&&(dojo.isArray(c)||(c=[c]))),this.converter&&this.converter.convert&&(c=this.converter.convert(c,this));return c},setValue:function(b,a){var c=void 0,c=dojox.wire.isWire(this.object)?this.object.getValue(a):this.object||a,d=void 0,e;if(this.property){if(!c)if(dojox.wire.isWire(this.object))c={},this.object.setValue(c,a);else throw Error(this._wireClass+".setValue(): invalid object");for(var d=this.property.split("."),f=
d.length-1,g=0;g<f;g++){var h=d[g];e=this._getPropertyValue(c,h);e||(e={},this._setPropertyValue(c,h,e));c=e}d=d[f]}if(this._setValue){if(d&&(e=this._getPropertyValue(c,d),e||(e={},this._setPropertyValue(c,d,e)),c=e),e=this._setValue(c,b),!c&&e)if(dojox.wire.isWire(this.object))this.object.setValue(e,a);else throw Error(this._wireClass+".setValue(): invalid object");}else if(d)this._setPropertyValue(c,d,b);else if(dojox.wire.isWire(this.object))this.object.setValue(b,a);else throw Error(this._wireClass+
".setValue(): invalid property");},_getPropertyValue:function(b,a){var c=void 0,d=a.indexOf("[");if(d>=0){var e=a.indexOf("]"),e=a.substring(d+1,e),f=null;d===0?f=b:(a=a.substring(0,d),(f=this._getPropertyValue(b,a))&&!dojo.isArray(f)&&(f=[f]));f&&(c=f[e])}else b.getPropertyValue?c=b.getPropertyValue(a):(c="get"+a.charAt(0).toUpperCase()+a.substring(1),c=this._useGet(b)?b.get(a):this._useAttr(b)?b.attr(a):b[c]?b[c]():b[a]);return c},_setPropertyValue:function(b,a,c){var d=a.indexOf("[");if(d>=0){var e=
a.indexOf("]"),e=a.substring(d+1,e),f=null;d===0?f=b:(a=a.substring(0,d),f=this._getPropertyValue(b,a),f||(f=[],this._setPropertyValue(b,a,f)));f[e]=c}else if(b.setPropertyValue)b.setPropertyValue(a,c);else if(d="set"+a.charAt(0).toUpperCase()+a.substring(1),this._useSet(b))b.set(a,c);else if(this._useAttr(b))b.attr(a,c);else if(b[d])b[d](c);else b[a]=c},_useGet:function(b){var a=!1;dojo.isFunction(b.get)&&(a=!0);return a},_useSet:function(b){var a=!1;dojo.isFunction(b.set)&&(a=!0);return a},_useAttr:function(b){var a=
!1;dojo.isFunction(b.attr)&&(a=!0);return a}}));