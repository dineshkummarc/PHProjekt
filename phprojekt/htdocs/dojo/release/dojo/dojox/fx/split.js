/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._hasResource["dojox.fx.split"]||(dojo._hasResource["dojox.fx.split"]=!0,dojo.provide("dojox.fx.split"),dojo.require("dojo.fx"),dojo.require("dojo.fx.easing"),dojo.mixin(dojox.fx,{_split:function(a){a.rows=a.rows||3;a.columns=a.columns||3;a.duration=a.duration||1E3;for(var b=a.node=dojo.byId(a.node),f=b.parentNode,j=dojo.body();f&&f!=j&&dojo.style(f,"position")=="static";)f=f.parentNode;for(var c=f!=j?dojo.position(f,!0):{x:0,y:0},f=dojo.position(b,!0),p=dojo.style(b,"height"),d=dojo.style(b,
"width"),n=dojo.style(b,"borderLeftWidth")+dojo.style(b,"borderRightWidth"),h=dojo.style(b,"borderTopWidth")+dojo.style(b,"borderBottomWidth"),j=Math.ceil(p/a.rows),e=Math.ceil(d/a.columns),g=dojo.create(b.tagName,{style:{position:"absolute",padding:0,margin:0,border:"none",top:f.y-c.y+"px",left:f.x-c.x+"px",height:p+h+"px",width:d+n+"px",background:"none",overflow:a.crop?"hidden":"visible",zIndex:dojo.style(b,"zIndex")}},b,"after"),c=[],n=dojo.create(b.tagName,{style:{position:"absolute",border:"none",
padding:0,margin:0,height:j+n+"px",width:e+h+"px",overflow:"hidden"}}),h=0,p=a.rows;h<p;h++)for(var d=0,k=a.columns;d<k;d++){var i=dojo.clone(n),l=dojo.clone(b),m=h*j,o=d*e;l.style.filter="";dojo.removeAttr(l,"id");dojo.style(i,{border:"none",overflow:"hidden",top:m+"px",left:o+"px"});dojo.style(l,{position:"static",opacity:"1",marginTop:-m+"px",marginLeft:-o+"px"});i.appendChild(l);g.appendChild(i);i=a.pieceAnimation(i,d,h,f);dojo.isArray(i)?c=c.concat(i):c.push(i)}b=dojo.fx.combine(c);dojo.connect(b,
"onEnd",b,function(){g.parentNode.removeChild(g)});a.onPlay&&dojo.connect(b,"onPlay",b,a.onPlay);a.onEnd&&dojo.connect(b,"onEnd",b,a.onEnd);return b},explode:function(a){var b=a.node=dojo.byId(a.node);a.rows=a.rows||3;a.columns=a.columns||3;a.distance=a.distance||1;a.duration=a.duration||1E3;a.random=a.random||0;if(!a.fade)a.fade=!0;if(typeof a.sync=="undefined")a.sync=!0;a.random=Math.abs(a.random);a.pieceAnimation=function(b,c,f,d){var n=d.h/a.rows,h=d.w/a.columns,e=a.distance*2,g=a.duration,k=
b.style,i=parseInt(k.top),l=parseInt(k.left),m=0,o=0,s=0;a.random&&(m=Math.random()*a.random+Math.max(1-a.random,0),e*=m,g*=m,m=a.unhide&&a.sync||!a.unhide&&!a.sync?a.duration-g:0,o=Math.random()-0.5,s=Math.random()-0.5);var f=(d.h-n)/2-n*f,c=(d.w-h)/2-h*c,d=Math.sqrt(Math.pow(c,2)+Math.pow(f,2)),q=parseInt(i-f*e+d*s),r=parseInt(l-c*e+d*o),e=dojo.animateProperty({node:b,duration:g,delay:m,easing:a.easing||(a.unhide?dojo.fx.easing.sinOut:dojo.fx.easing.circOut),beforeBegin:a.unhide?function(){a.fade&&
dojo.style(b,{opacity:"0"});k.top=q+"px";k.left=r+"px"}:void 0,properties:{top:a.unhide?{start:q,end:i}:{start:i,end:q},left:a.unhide?{start:r,end:l}:{start:l,end:r}}});return a.fade?(g=dojo.animateProperty({node:b,duration:g,delay:m,easing:a.fadeEasing||dojo.fx.easing.quadOut,properties:{opacity:a.unhide?{start:"0",end:"1"}:{start:"1",end:"0"}}}),a.unhide?[g,e]:[e,g]):e};var f=dojox.fx._split(a);a.unhide?dojo.connect(f,"onEnd",null,function(){dojo.style(b,{opacity:"1"})}):dojo.connect(f,"onPlay",
null,function(){dojo.style(b,{opacity:"0"})});return f},converge:function(a){a.unhide=!0;return dojox.fx.explode(a)},disintegrate:function(a){var b=a.node=dojo.byId(a.node);a.rows=a.rows||5;a.columns=a.columns||5;a.duration=a.duration||1500;a.interval=a.interval||a.duration/(a.rows+a.columns*2);a.distance=a.distance||1.5;a.random=a.random||0;if(typeof a.fade=="undefined")a.fade=!0;var f=Math.abs(a.random),j=a.duration-(a.rows+a.columns)*a.interval;a.pieceAnimation=function(b,d,c,h){var e=b.style,
d=Math.random()*(a.rows+a.columns)*a.interval*f+Math.max(1-f,0)*(a.reverseOrder||a.distance<0?(d+c)*a.interval:(a.rows+a.columns-(d+c))*a.interval),g={};if(a.unhide){if(g.top={start:parseInt(e.top)-h.h*a.distance,end:parseInt(e.top)},a.fade)g.opacity={start:"0",end:"1"}}else if(g.top={end:parseInt(e.top)+h.h*a.distance},a.fade)g.opacity={end:"0"};return dojo.animateProperty({node:b,duration:j,delay:d,easing:a.easing||(a.unhide?dojo.fx.easing.sinIn:dojo.fx.easing.circIn),properties:g,beforeBegin:a.unhide?
function(){a.fade&&dojo.style(b,{opacity:"0"});e.top=g.top.start+"px"}:void 0})};var c=dojox.fx._split(a);a.unhide?dojo.connect(c,"onEnd",c,function(){dojo.style(b,{opacity:"1"})}):dojo.connect(c,"onPlay",c,function(){dojo.style(b,{opacity:"0"})});return c},build:function(a){a.unhide=!0;return dojox.fx.disintegrate(a)},shear:function(a){var b=a.node=dojo.byId(a.node);a.rows=a.rows||6;a.columns=a.columns||6;a.duration=a.duration||1E3;a.interval=a.interval||0;a.distance=a.distance||1;a.random=a.random||
0;if(typeof a.fade=="undefined")a.fade=!0;var f=Math.abs(a.random),j=a.duration-(a.rows+a.columns)*Math.abs(a.interval);a.pieceAnimation=function(b,d,c,h){var e=!(d%2),g=!(c%2),d=Math.random()*j*f+Math.max(1-f,0)*(a.reverseOrder?(a.rows+a.columns-(d+c))*a.interval:(d+c)*a.interval),k={},i=b.style;if(a.fade)k.opacity=a.unhide?{start:"0",end:"1"}:{end:"0"};a.columns==1?e=g:a.rows==1&&(g=!e);var c=parseInt(i.left),l=parseInt(i.top),m=a.distance*h.w,h=a.distance*h.h;a.unhide?e==g?k.left=e?{start:c-m,
end:c}:{start:c+m,end:c}:k.top=e?{start:l+h,end:l}:{start:l-h,end:l}:e==g?k.left=e?{end:c-m}:{end:c+m}:k.top=e?{end:l+h}:{end:l-h};return dojo.animateProperty({node:b,duration:j,delay:d,easing:a.easing||dojo.fx.easing.sinInOut,properties:k,beforeBegin:a.unhide?function(){if(a.fade)i.opacity="0";e==g?i.left=k.left.start+"px":i.top=k.top.start+"px"}:void 0})};var c=dojox.fx._split(a);a.unhide?dojo.connect(c,"onEnd",c,function(){dojo.style(b,{opacity:"1"})}):dojo.connect(c,"onPlay",c,function(){dojo.style(b,
{opacity:"0"})});return c},unShear:function(a){a.unhide=!0;return dojox.fx.shear(a)},pinwheel:function(a){var b=a.node=dojo.byId(a.node);a.rows=a.rows||4;a.columns=a.columns||4;a.duration=a.duration||1E3;a.interval=a.interval||0;a.distance=a.distance||1;a.random=a.random||0;if(typeof a.fade=="undefined")a.fade=!0;var f=a.duration-(a.rows+a.columns)*Math.abs(a.interval);a.pieceAnimation=function(b,j,d,n){var h=n.h/a.rows,e=n.w/a.columns,g=!(j%2),k=!(d%2),j=Math.random()*f*a.random+Math.max(1-a.random,
0)*(a.interval<0?(a.rows+a.columns-(j+d))*a.interval*-1:(j+d)*a.interval),d={},i=b.style;if(a.fade)d.opacity=a.unhide?{start:0,end:1}:{end:0};a.columns==1?g=!k:a.rows==1&&(k=g);var l=parseInt(i.left),m=parseInt(i.top);if(g)k?d.top=a.unhide?{start:m+h*a.distance,end:m}:{start:m,end:m+h*a.distance}:d.left=a.unhide?{start:l+e*a.distance,end:l}:{start:l,end:l+e*a.distance};g!=k?d.width=a.unhide?{start:e*(1-a.distance),end:e}:{start:e,end:e*(1-a.distance)}:d.height=a.unhide?{start:h*(1-a.distance),end:h}:
{start:h,end:h*(1-a.distance)};return dojo.animateProperty({node:b,duration:f,delay:j,easing:a.easing||dojo.fx.easing.sinInOut,properties:d,beforeBegin:a.unhide?function(){a.fade&&dojo.style(b,"opacity",0);g?k?i.top=m+h*(1-a.distance)+"px":i.left=l+e*(1-a.distance)+"px":(i.left=l+"px",i.top=m+"px");g!=k?i.width=e*(1-a.distance)+"px":i.height=h*(1-a.distance)+"px"}:void 0})};var j=dojox.fx._split(a);a.unhide?dojo.connect(j,"onEnd",j,function(){dojo.style(b,{opacity:"1"})}):dojo.connect(j,"play",j,
function(){dojo.style(b,{opacity:"0"})});return j},unPinwheel:function(a){a.unhide=!0;return dojox.fx.pinwheel(a)},blockFadeOut:function(a){var b=a.node=dojo.byId(a.node);a.rows=a.rows||5;a.columns=a.columns||5;a.duration=a.duration||1E3;a.interval=a.interval||a.duration/(a.rows+a.columns*2);a.random=a.random||0;var f=Math.abs(a.random),j=a.duration-(a.rows+a.columns)*a.interval;a.pieceAnimation=function(b,c,n){return dojo.animateProperty({node:b,duration:j,delay:Math.random()*a.duration*f+Math.max(1-
f,0)*(a.reverseOrder?(a.rows+a.columns-(c+n))*Math.abs(a.interval):(c+n)*a.interval),easing:a.easing||dojo.fx.easing.sinInOut,properties:{opacity:a.unhide?{start:"0",end:"1"}:{start:"1",end:"0"}},beforeBegin:a.unhide?function(){dojo.style(b,{opacity:"0"})}:function(){b.style.filter=""}})};var c=dojox.fx._split(a);a.unhide?dojo.connect(c,"onEnd",c,function(){dojo.style(b,{opacity:"1"})}):dojo.connect(c,"onPlay",c,function(){dojo.style(b,{opacity:"0"})});return c},blockFadeIn:function(a){a.unhide=!0;
return dojox.fx.blockFadeOut(a)}}));