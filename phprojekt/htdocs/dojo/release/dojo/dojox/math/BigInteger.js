/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._hasResource["dojox.math.BigInteger"]||(dojo._hasResource["dojox.math.BigInteger"]=!0,dojo.provide("dojox.math.BigInteger"),dojo.getObject("math.BigInteger",!0,dojox),dojo.experimental("dojox.math.BigInteger"),function(){function j(a,b,c){a!=null&&("number"==typeof a?this._fromNumber(a,b,c):!b&&"string"!=typeof a?this._fromString(a,256):this._fromString(a,b))}function k(){return new j(null)}function u(a,b,c,d,f,e){for(;--e>=0;){var g=b*this[a++]+c[d]+f,f=Math.floor(g/67108864);c[d++]=g&67108863}return f}
function v(a,b,c,d,f,e){var g=b&32767;for(b>>=15;--e>=0;){var h=this[a]&32767,j=this[a++]>>15,i=b*h+j*g,h=g*h+((i&32767)<<15)+c[d]+(f&1073741823),f=(h>>>30)+(i>>>15)+b*j+(f>>>30);c[d++]=h&1073741823}return f}function w(a,b,c,d,f,e){var g=b&16383;for(b>>=14;--e>=0;){var h=this[a]&16383,j=this[a++]>>14,i=b*h+j*g,h=g*h+((i&16383)<<14)+c[d]+f,f=(h>>28)+(i>>14)+b*j;c[d++]=h&268435455}return f}function p(a){var b=k();b._fromInt(a);return b}function r(a){var b=1,c;if(c=a>>>16)a=c,b+=16;if(c=a>>8)a=c,b+=
8;if(c=a>>4)a=c,b+=4;if(c=a>>2)a=c,b+=2;a>>1&&(b+=1);return b}function t(a){this.m=a}function s(a){this.m=a;this.mp=a._invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<a._DB-15)-1;this.mt2=2*a.t}var l;navigator.appName=="Microsoft Internet Explorer"?(j.prototype.am=v,l=30):navigator.appName!="Netscape"?(j.prototype.am=u,l=26):(j.prototype.am=w,l=28);var m=[],n,i;n="0".charCodeAt(0);for(i=0;i<=9;++i)m[n++]=i;n="a".charCodeAt(0);for(i=10;i<36;++i)m[n++]=i;n="A".charCodeAt(0);for(i=
10;i<36;++i)m[n++]=i;dojo.extend(t,{convert:function(a){return a.s<0||a.compareTo(this.m)>=0?a.mod(this.m):a},revert:function(a){return a},reduce:function(a){a._divRemTo(this.m,null,a)},mulTo:function(a,b,c){a._multiplyTo(b,c);this.reduce(c)},sqrTo:function(a,b){a._squareTo(b);this.reduce(b)}});dojo.extend(s,{convert:function(a){var b=k();a.abs()._dlShiftTo(this.m.t,b);b._divRemTo(this.m,null,b);a.s<0&&b.compareTo(j.ZERO)>0&&this.m._subTo(b,b);return b},revert:function(a){var b=k();a._copyTo(b);this.reduce(b);
return b},reduce:function(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=a[b]&32767,d=c*this.mpl+((c*this.mph+(a[b]>>15)*this.mpl&this.um)<<15)&a._DM,c=b+this.m.t;for(a[c]+=this.m.am(0,d,a,b,0,this.m.t);a[c]>=a._DV;)a[c]-=a._DV,a[++c]++}a._clamp();a._drShiftTo(this.m.t,a);a.compareTo(this.m)>=0&&a._subTo(this.m,a)},mulTo:function(a,b,c){a._multiplyTo(b,c);this.reduce(c)},sqrTo:function(a,b){a._squareTo(b);this.reduce(b)}});dojo.extend(j,{_DB:l,_DM:(1<<l)-1,_DV:1<<l,_FV:Math.pow(2,
52),_F1:52-l,_F2:2*l-52,_copyTo:function(a){for(var b=this.t-1;b>=0;--b)a[b]=this[b];a.t=this.t;a.s=this.s},_fromInt:function(a){this.t=1;this.s=a<0?-1:0;a>0?this[0]=a:a<-1?this[0]=a+_DV:this.t=0},_fromString:function(a,b){var c;if(b==16)c=4;else if(b==8)c=3;else if(b==256)c=8;else if(b==2)c=1;else if(b==32)c=5;else if(b==4)c=2;else{this.fromRadix(a,b);return}this.s=this.t=0;for(var d=a.length,f=!1,e=0;--d>=0;){var g;c==8?g=a[d]&255:(g=m[a.charCodeAt(d)],g=g==null?-1:g);g<0?a.charAt(d)=="-"&&(f=!0):
(f=!1,e==0?this[this.t++]=g:e+c>this._DB?(this[this.t-1]|=(g&(1<<this._DB-e)-1)<<e,this[this.t++]=g>>this._DB-e):this[this.t-1]|=g<<e,e+=c,e>=this._DB&&(e-=this._DB))}if(c==8&&(a[0]&128)!=0)this.s=-1,e>0&&(this[this.t-1]|=(1<<this._DB-e)-1<<e);this._clamp();f&&j.ZERO._subTo(this,this)},_clamp:function(){for(var a=this.s&this._DM;this.t>0&&this[this.t-1]==a;)--this.t},_dlShiftTo:function(a,b){var c;for(c=this.t-1;c>=0;--c)b[c+a]=this[c];for(c=a-1;c>=0;--c)b[c]=0;b.t=this.t+a;b.s=this.s},_drShiftTo:function(a,
b){for(var c=a;c<this.t;++c)b[c-a]=this[c];b.t=Math.max(this.t-a,0);b.s=this.s},_lShiftTo:function(a,b){var c=a%this._DB,d=this._DB-c,f=(1<<d)-1,e=Math.floor(a/this._DB),g=this.s<<c&this._DM,h;for(h=this.t-1;h>=0;--h)b[h+e+1]=this[h]>>d|g,g=(this[h]&f)<<c;for(h=e-1;h>=0;--h)b[h]=0;b[e]=g;b.t=this.t+e+1;b.s=this.s;b._clamp()},_rShiftTo:function(a,b){b.s=this.s;var c=Math.floor(a/this._DB);if(c>=this.t)b.t=0;else{var d=a%this._DB,f=this._DB-d,e=(1<<d)-1;b[0]=this[c]>>d;for(var g=c+1;g<this.t;++g)b[g-
c-1]|=(this[g]&e)<<f,b[g-c]=this[g]>>d;d>0&&(b[this.t-c-1]|=(this.s&e)<<f);b.t=this.t-c;b._clamp()}},_subTo:function(a,b){for(var c=0,d=0,f=Math.min(a.t,this.t);c<f;)d+=this[c]-a[c],b[c++]=d&this._DM,d>>=this._DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this[c],b[c++]=d&this._DM,d>>=this._DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a[c],b[c++]=d&this._DM,d>>=this._DB;d-=a.s}b.s=d<0?-1:0;d<-1?b[c++]=this._DV+d:d>0&&(b[c++]=d);b.t=c;b._clamp()},_multiplyTo:function(a,b){var c=this.abs(),d=a.abs(),f=c.t;
for(b.t=f+d.t;--f>=0;)b[f]=0;for(f=0;f<d.t;++f)b[f+c.t]=c.am(0,d[f],b,f,0,c.t);b.s=0;b._clamp();this.s!=a.s&&j.ZERO._subTo(b,b)},_squareTo:function(a){for(var b=this.abs(),c=a.t=2*b.t;--c>=0;)a[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b[c],a,2*c,0,1);if((a[c+b.t]+=b.am(c+1,2*b[c],a,2*c+1,d,b.t-c-1))>=b._DV)a[c+b.t]-=b._DV,a[c+b.t+1]=1}a.t>0&&(a[a.t-1]+=b.am(c,b[c],a,2*c,0,1));a.s=0;a._clamp()},_divRemTo:function(a,b,c){var d=a.abs();if(!(d.t<=0)){var f=this.abs();if(f.t<d.t)b!=null&&b._fromInt(0),c!=
null&&this._copyTo(c);else{c==null&&(c=k());var e=k(),g=this.s,a=a.s,h=this._DB-r(d[d.t-1]);h>0?(d._lShiftTo(h,e),f._lShiftTo(h,c)):(d._copyTo(e),f._copyTo(c));d=e.t;f=e[d-1];if(f!=0){var i=f*(1<<this._F1)+(d>1?e[d-2]>>this._F2:0),l=this._FV/i,i=(1<<this._F1)/i,n=1<<this._F2,q=c.t,m=q-d,o=b==null?k():b;e._dlShiftTo(m,o);c.compareTo(o)>=0&&(c[c.t++]=1,c._subTo(o,c));j.ONE._dlShiftTo(d,o);for(o._subTo(e,e);e.t<d;)e[e.t++]=0;for(;--m>=0;){var p=c[--q]==f?this._DM:Math.floor(c[q]*l+(c[q-1]+n)*i);if((c[q]+=
e.am(0,p,c,m,0,d))<p){e._dlShiftTo(m,o);for(c._subTo(o,c);c[q]<--p;)c._subTo(o,c)}}b!=null&&(c._drShiftTo(d,b),g!=a&&j.ZERO._subTo(b,b));c.t=d;c._clamp();h>0&&c._rShiftTo(h,c);g<0&&j.ZERO._subTo(c,c)}}}},_invDigit:function(){if(this.t<1)return 0;var a=this[0];if((a&1)==0)return 0;var b=a&3,b=b*(2-(a&15)*b)&15,b=b*(2-(a&255)*b)&255,b=b*(2-((a&65535)*b&65535))&65535,b=b*(2-a*b%this._DV)%this._DV;return b>0?this._DV-b:-b},_isEven:function(){return(this.t>0?this[0]&1:this.s)==0},_exp:function(a,b){if(a>
4294967295||a<1)return j.ONE;var c=k(),d=k(),f=b.convert(this),e=r(a)-1;for(f._copyTo(c);--e>=0;)if(b.sqrTo(c,d),(a&1<<e)>0)b.mulTo(d,f,c);else var g=c,c=d,d=g;return b.revert(c)},toString:function(a){if(this.s<0)return"-"+this.negate().toString(a);if(a==16)a=4;else if(a==8)a=3;else if(a==2)a=1;else if(a==32)a=5;else if(a==4)a=2;else return this._toRadix(a);var b=(1<<a)-1,c,d=!1,f="",e=this.t,g=this._DB-e*this._DB%a;if(e-- >0){if(g<this._DB&&(c=this[e]>>g)>0)d=!0,f="0123456789abcdefghijklmnopqrstuvwxyz".charAt(c);
for(;e>=0;)g<a?(c=(this[e]&(1<<g)-1)<<a-g,c|=this[--e]>>(g+=this._DB-a)):(c=this[e]>>(g-=a)&b,g<=0&&(g+=this._DB,--e)),c>0&&(d=!0),d&&(f+="0123456789abcdefghijklmnopqrstuvwxyz".charAt(c))}return d?f:"0"},negate:function(){var a=k();j.ZERO._subTo(this,a);return a},abs:function(){return this.s<0?this.negate():this},compareTo:function(a){var b=this.s-a.s;if(b)return b;var c=this.t;if(b=c-a.t)return b;for(;--c>=0;)if(b=this[c]-a[c])return b;return 0},bitLength:function(){return this.t<=0?0:this._DB*(this.t-
1)+r(this[this.t-1]^this.s&this._DM)},mod:function(a){var b=k();this.abs()._divRemTo(a,null,b);this.s<0&&b.compareTo(j.ZERO)>0&&a._subTo(b,b);return b},modPowInt:function(a,b){var c;c=a<256||b._isEven()?new t(b):new s(b);return this._exp(a,c)}});dojo._mixin(j,{ZERO:p(0),ONE:p(1),_nbi:k,_nbv:p,_nbits:r,_Montgomery:s});dojox.math.BigInteger=j}());