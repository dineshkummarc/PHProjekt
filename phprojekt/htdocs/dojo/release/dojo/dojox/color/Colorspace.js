/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["dojox.color.Colorspace"])dojo._hasResource["dojox.color.Colorspace"]=!0,dojo.provide("dojox.color.Colorspace"),dojo.require("dojox.math.matrix"),dojox.color.Colorspace=new function(){var d=dojox.color,e=dojox.math.matrix,h=this,g={2:{E:{x:1/3,y:1/3,t:5400},D50:{x:0.34567,y:0.3585,t:5E3},D55:{x:0.33242,y:0.34743,t:5500},D65:{x:0.31271,y:0.32902,t:6500},D75:{x:0.29902,y:0.31485,t:7500},A:{x:0.44757,y:0.40745,t:2856},B:{x:0.34842,y:0.35161,t:4874},C:{x:0.31006,y:0.31616,t:6774},
9300:{x:0.2848,y:0.2932,t:9300},F2:{x:0.37207,y:0.37512,t:4200},F7:{x:0.31285,y:0.32918,t:6500},F11:{x:0.38054,y:0.37691,t:4E3}},10:{E:{x:1/3,y:1/3,t:5400},D50:{x:0.34773,y:0.35952,t:5E3},D55:{x:0.33411,y:0.34877,t:5500},D65:{x:0.31382,y:0.331,t:6500},D75:{x:0.29968,y:0.3174,t:7500},A:{x:0.45117,y:0.40594,t:2856},B:{x:0.3498,y:0.3527,t:4874},C:{x:0.31039,y:0.31905,t:6774},F2:{x:0.37928,y:0.36723,t:4200},F7:{x:0.31565,y:0.32951,t:6500},F11:{x:0.38543,y:0.3711,t:4E3}}},i={"Adobe RGB 98":[2.2,"D65",
0.64,0.33,0.297361,0.21,0.71,0.627355,0.15,0.06,0.075285],"Apple RGB":[1.8,"D65",0.625,0.34,0.244634,0.28,0.595,0.672034,0.155,0.07,0.083332],"Best RGB":[2.2,"D50",0.7347,0.2653,0.228457,0.215,0.775,0.737352,0.13,0.035,0.034191],"Beta RGB":[2.2,"D50",0.6888,0.3112,0.303273,0.1986,0.7551,0.663786,0.1265,0.0352,0.032941],"Bruce RGB":[2.2,"D65",0.64,0.33,0.240995,0.28,0.65,0.683554,0.15,0.06,0.075452],"CIE RGB":[2.2,"E",0.735,0.265,0.176204,0.274,0.717,0.812985,0.167,0.009,0.010811],"ColorMatch RGB":[1.8,
"D50",0.63,0.34,0.274884,0.295,0.605,0.658132,0.15,0.075,0.066985],"DON RGB 4":[2.2,"D50",0.696,0.3,0.27835,0.215,0.765,0.68797,0.13,0.035,0.03368],"ECI RGB":[1.8,"D50",0.67,0.33,0.32025,0.21,0.71,0.602071,0.14,0.08,0.077679],"EktaSpace PS5":[2.2,"D50",0.695,0.305,0.260629,0.26,0.7,0.734946,0.11,0.005,0.004425],"NTSC RGB":[2.2,"C",0.67,0.33,0.298839,0.21,0.71,0.586811,0.14,0.08,0.11435],"PAL/SECAM RGB":[2.2,"D65",0.64,0.33,0.222021,0.29,0.6,0.706645,0.15,0.06,0.071334],"Pro Photo RGB":[1.8,"D50",
0.7347,0.2653,0.28804,0.1596,0.8404,0.711874,0.0366,1.0E-4,8.6E-5],"SMPTE/C RGB":[2.2,"D65",0.63,0.34,0.212395,0.31,0.595,0.701049,0.155,0.07,0.086556],sRGB:[2.2,"D65",0.64,0.33,0.212656,0.3,0.6,0.715158,0.15,0.06,0.072186],"Wide Gamut RGB":[2.2,"D50",0.735,0.265,0.258187,0.115,0.826,0.724938,0.157,0.018,0.016875]},j={"XYZ scaling":{ma:[[1,0,0],[0,1,0],[0,0,1]],mai:[[1,0,0],[0,1,0],[0,0,1]]},Bradford:{ma:[[0.8951,-0.7502,0.0389],[0.2664,1.7135,-0.0685],[-0.1614,0.0367,1.0296]],mai:[[0.986993,0.432305,
-0.008529],[-0.147054,0.51836,0.040043],[0.159963,0.049291,0.968487]]},"Von Kries":{ma:[[0.40024,-0.2263,0],[0.7076,1.16532,0],[-0.08081,0.0457,0.91822]],mai:[[1.859936,0.361191,0],[-1.129382,0.638812,0],[0.219897,-6.0E-6,1.089064]]}},c={XYZ:{xyY:function(a,b){var b=dojo.mixin({whitepoint:"D65",observer:"10",useApproximation:!0},b||{}),c=h.whitepoint(b.whitepoint,b.observer),d=a.X+a.Y+a.Z;if(d==0)var f=c.x,c=c.y;else f=a.X/d,c=a.Y/d;return{x:f,y:c,Y:a.Y}},Lab:function(a,b){var b=dojo.mixin({whitepoint:"D65",
observer:"10",useApproximation:!0},b||{}),c=h.kappa(b.useApproximation),d=h.epsilon(b.useApproximation),f=h.whitepoint(b.whitepoint,b.observer),g=a.X/f.x,e=a.Y/f.y,f=a.z/f.z,e=e>d?Math.pow(e,1/3):(c*e+16)/116;return{L:116*e-16,a:500*((g>d?Math.pow(g,1/3):(c*g+16)/116)-e),b:200*(e-(f>d?Math.pow(f,1/3):(c*f+16)/116))}},Luv:function(a,b){var b=dojo.mixin({whitepoint:"D65",observer:"10",useApproximation:!0},b||{}),c=h.kappa(b.useApproximation),d=h.epsilon(b.useApproximation),f=h.whitepoint(b.whitepoint,
b.observer),e=a.Y/f.y,c=e>d?116*Math.pow(e,1/3)-16:c*e;return{L:c,u:13*c*(4*a.X/(a.X+15*a.Y+3*a.Z)-4*f.x/(f.x+15*f.y+3*f.z)),v:13*c*(9*a.Y/(a.X+15*a.Y+3*a.Z)-9*f.y/(f.x+15*f.y+3*f.z))}}},xyY:{XYZ:function(a){if(a.y==0)var b=0,c=0,a=0;else b=a.x*a.Y/a.y,c=a.Y,a=(1-a.x-a.y)*a.Y/a.y;return{X:b,Y:c,Z:a}}},Lab:{XYZ:function(a,b){var b=dojo.mixin({whitepoint:"D65",observer:"10",useApproximation:!0},b||{}),c=b.useApproximation,d=h.kappa(c),c=h.epsilon(c),f=h.whitepoint(b.whitepoint,b.observer),e=a.L>d*c?
Math.pow((a.L+16)/116,3):a.L/d,g=e>c?(a.L+16)/116:(d*e+16)/116,i=a.a/500+g;g-=a.b/200;var j=Math.pow(i,3),l=Math.pow(g,3);return{X:(j>c?j:(116*i-16)/d)*f.x,Y:e*f.y,Z:(l>c?l:(116*g-16)/d)*f.z}},LCHab:function(a){var b=a.L,c=Math.pow(a.a*a.a+a.b*a.b,0.5),a=Math.atan(a.b,a.a)*(180/Math.PI);a<0&&(a+=360);a<360&&(a-=360);return{L:b,C:c,H:a}}},LCHab:{Lab:function(a){var b=a.L,c=a.C/Math.pow(Math.pow(Math.tan(a.H*(Math.PI/180)),2)+1,0.5);90<lchH&&a.H<270&&(c=-c);var d=Math.pow(Math.pow(a.C,2)-Math.pow(c,
2),0.5);a.H>180&&(d=-d);return{L:b,a:c,b:d}}},Luv:{XYZ:function(a,b){var b=dojo.mixin({whitepoint:"D65",observer:"10",useApproximation:!0},b||{}),c=b.useApproximation,d=h.kappa(c),f=h.epsilon(c),c=h.whitepoint(b.whitepoint,b.observer),e=9*c.y/(c.x+15*c.y+3*c.z),d=a.L>d*f?Math.pow((a.L+16)/116,3):a.L/d,f=1/3*(52*a.L/(a.u+13*a.L*(4*c.x/(c.x+15*c.y+3*c.z)))-1),c=-5*d,e=(d*(39*a.L/(a.v+13*a.L*e)-5)-c)/(f- -(1/3));return{X:e,Y:d,Z:e*f+c}},LCHuv:function(a){var b=a.L,c=Math.pow(a.u*a.u+a.v*a*v,0.5),a=Math.atan(a.v,
a.u)*(180/Math.PI);a<0&&(a+=360);a>360&&(a-=360);return{L:b,C:c,H:a}}},LCHuv:{Luv:function(a){var b=a.L,c=a.C/Math.pow(Math.pow(Math.tan(a.H*(Math.PI/180)),2)+1,0.5),d=Math.pow(a.C*a.C-c*c,0.5);90<a.H&&a.H>270&&(c*=-1);a.H>180&&(d*=-1);return{L:b,u:c,v:d}}}},k={CMY:{CMYK:function(a){return d.fromCmy(a).toCmyk()},HSL:function(a){return d.fromCmy(a).toHsl()},HSV:function(a){return d.fromCmy(a).toHsv()},Lab:function(a,b){return c.XYZ.Lab(d.fromCmy(a).toXYZ(b))},LCHab:function(a){return c.Lab.LCHab(k.CMY.Lab(a))},
LCHuv:function(a,b){return c.LCHuv.Luv(c.Luv.XYZ(d.fromCmy(a).toXYZ(b)))},Luv:function(a,b){return c.Luv.XYZ(d.fromCmy(a).toXYZ(b))},RGB:function(a){return d.fromCmy(a)},XYZ:function(a,b){return d.fromCmy(a).toXYZ(b)},xyY:function(a,b){return c.XYZ.xyY(d.fromCmy(a).toXYZ(b))}},CMYK:{CMY:function(a){return d.fromCmyk(a).toCmy()},HSL:function(a){return d.fromCmyk(a).toHsl()},HSV:function(a){return d.fromCmyk(a).toHsv()},Lab:function(a,b){return c.XYZ.Lab(d.fromCmyk(a).toXYZ(b))},LCHab:function(a){return c.Lab.LCHab(k.CMYK.Lab(a))},
LCHuv:function(a,b){return c.LCHuv.Luv(c.Luv.XYZ(d.fromCmyk(a).toXYZ(b)))},Luv:function(a,b){return c.Luv.XYZ(d.fromCmyk(a).toXYZ(b))},RGB:function(a){return d.fromCmyk(a)},XYZ:function(a,b){return d.fromCmyk(a).toXYZ(b)},xyY:function(a,b){return c.XYZ.xyY(d.fromCmyk(a).toXYZ(b))}},HSL:{CMY:function(a){return d.fromHsl(a).toCmy()},CMYK:function(a){return d.fromHsl(a).toCmyk()},HSV:function(a){return d.fromHsl(a).toHsv()},Lab:function(a,b){return c.XYZ.Lab(d.fromHsl(a).toXYZ(b))},LCHab:function(a){return c.Lab.LCHab(k.CMYK.Lab(a))},
LCHuv:function(a,b){return c.LCHuv.Luv(c.Luv.XYZ(d.fromHsl(a).toXYZ(b)))},Luv:function(a,b){return c.Luv.XYZ(d.fromHsl(a).toXYZ(b))},RGB:function(a){return d.fromHsl(a)},XYZ:function(a,b){return d.fromHsl(a).toXYZ(b)},xyY:function(a,b){return c.XYZ.xyY(d.fromHsl(a).toXYZ(b))}},HSV:{CMY:function(a){return d.fromHsv(a).toCmy()},CMYK:function(a){return d.fromHsv(a).toCmyk()},HSL:function(a){return d.fromHsv(a).toHsl()},Lab:function(a,b){return c.XYZ.Lab(d.fromHsv(a).toXYZ(b))},LCHab:function(a){return c.Lab.LCHab(k.CMYK.Lab(a))},
LCHuv:function(a,b){return c.LCHuv.Luv(c.Luv.XYZ(d.fromHsv(a).toXYZ(b)))},Luv:function(a,b){return c.Luv.XYZ(d.fromHsv(a).toXYZ(b))},RGB:function(a){return d.fromHsv(a)},XYZ:function(a,b){return d.fromHsv(a).toXYZ(b)},xyY:function(a,b){return c.XYZ.xyY(d.fromHsv(a).toXYZ(b))}},Lab:{CMY:function(a,b){return d.fromXYZ(c.Lab.XYZ(a,b)).toCmy()},CMYK:function(a,b){return d.fromXYZ(c.Lab.XYZ(a,b)).toCmyk()},HSL:function(a,b){return d.fromXYZ(c.Lab.XYZ(a,b)).toHsl()},HSV:function(a,b){return d.fromXYZ(c.Lab.XYZ(a,
b)).toHsv()},LCHab:function(a,b){return c.Lab.LCHab(a,b)},LCHuv:function(a,b){return c.Luv.LCHuv(c.Lab.XYZ(a,b),b)},Luv:function(a,b){return c.XYZ.Luv(c.Lab.XYZ(a,b),b)},RGB:function(a,b){return d.fromXYZ(c.Lab.XYZ(a,b))},XYZ:function(a,b){return c.Lab.XYZ(a,b)},xyY:function(a,b){return c.XYZ.xyY(c.Lab.XYZ(a,b),b)}},LCHab:{CMY:function(a,b){return d.fromXYZ(c.Lab.XYZ(c.LCHab.Lab(a),b),b).toCmy()},CMYK:function(a,b){return d.fromXYZ(c.Lab.XYZ(c.LCHab.Lab(a),b),b).toCmyk()},HSL:function(a,b){return d.fromXYZ(c.Lab.XYZ(c.LCHab.Lab(a),
b),b).toHsl()},HSV:function(a,b){return d.fromXYZ(c.Lab.XYZ(c.LCHab.Lab(a),b),b).toHsv()},Lab:function(a,b){return c.Lab.LCHab(a,b)},LCHuv:function(a,b){return c.Luv.LCHuv(c.XYZ.Luv(c.Lab.XYZ(c.LCHab.Lab(a),b),b),b)},Luv:function(a,b){return c.XYZ.Luv(c.Lab.XYZ(c.LCHab.Lab(a),b),b)},RGB:function(a,b){return d.fromXYZ(c.Lab.XYZ(c.LCHab.Lab(a),b),b)},XYZ:function(a,b){return c.Lab.XYZ(c.LCHab.Lab(a,b),b)},xyY:function(a,b){return c.XYZ.xyY(c.Lab.XYZ(c.LCHab.Lab(a),b),b)}},LCHuv:{CMY:function(a,b){return d.fromXYZ(c.Luv.XYZ(c.LCHuv.Luv(a),
b),b).toCmy()},CMYK:function(a,b){return d.fromXYZ(c.Luv.XYZ(c.LCHuv.Luv(a),b),b).toCmyk()},HSL:function(a,b){return d.fromXYZ(c.Luv.XYZ(c.LCHuv.Luv(a),b),b).toHsl()},HSV:function(a,b){return d.fromXYZ(c.Luv.XYZ(c.LCHuv.Luv(a),b),b).toHsv()},Lab:function(a,b){return c.XYZ.Lab(c.Luv.XYZ(c.LCHuv.Luv(a),b),b)},LCHab:function(a,b){return c.Lab.LCHab(c.XYZ.Lab(c.Luv.XYZ(c.LCHuv.Luv(a),b),b),b)},Luv:function(a,b){return c.LCHuv.Luv(a,b)},RGB:function(a,b){return d.fromXYZ(c.Luv.XYZ(c.LCHuv.Luv(a),b),b)},
XYZ:function(a,b){return c.Luv.XYZ(c.LCHuv.Luv(a),b)},xyY:function(a,b){return c.XYZ.xyY(c.Luv.XYZ(c.LCHuv.Luv(a),b),b)}},Luv:{CMY:function(a,b){return d.fromXYZ(c.Luv.XYZ(a,b),b).toCmy()},CMYK:function(a,b){return d.fromXYZ(c.Luv.XYZ(a,b),b).toCmyk()},HSL:function(a,b){return d.fromXYZ(c.Luv.XYZ(a,b),b).toHsl()},HSV:function(a,b){return d.fromXYZ(c.Luv.XYZ(a,b),b).toHsv()},Lab:function(a,b){return c.XYZ.Lab(c.Luv.XYZ(a,b),b)},LCHab:function(a,b){return c.Lab.LCHab(c.XYZ.Lab(c.Luv.XYZ(a,b),b),b)},
LCHuv:function(a,b){return c.Luv.LCHuv(a,b)},RGB:function(a,b){return d.fromXYZ(c.Luv.XYZ(a,b),b)},XYZ:function(a,b){return c.Luv.XYZ(a,b)},xyY:function(a,b){return c.XYZ.xyY(c.Luv.XYZ(a,b),b)}},RGB:{CMY:function(a){return a.toCmy()},CMYK:function(a){return a.toCmyk()},HSL:function(a){return a.toHsl()},HSV:function(a){return a.toHsv()},Lab:function(a,b){return c.XYZ.Lab(a.toXYZ(b),b)},LCHab:function(a,b){return c.LCHab.Lab(c.XYZ.Lab(a.toXYZ(b),b),b)},LCHuv:function(a,b){return c.LCHuv.Luv(c.XYZ.Luv(a.toXYZ(b),
b),b)},Luv:function(a,b){return c.XYZ.Luv(a.toXYZ(b),b)},XYZ:function(a,b){return a.toXYZ(b)},xyY:function(a,b){return c.XYZ.xyY(a.toXYZ(b),b)}},XYZ:{CMY:function(a,b){return d.fromXYZ(a,b).toCmy()},CMYK:function(a,b){return d.fromXYZ(a,b).toCmyk()},HSL:function(a,b){return d.fromXYZ(a,b).toHsl()},HSV:function(a,b){return d.fromXYZ(a,b).toHsv()},Lab:function(a,b){return c.XYZ.Lab(a,b)},LCHab:function(a,b){return c.Lab.LCHab(c.XYZ.Lab(a,b),b)},LCHuv:function(a,b){return c.Luv.LCHuv(c.XYZ.Luv(a,b),
b)},Luv:function(a,b){return c.XYZ.Luv(a,b)},RGB:function(a,b){return d.fromXYZ(a,b)},xyY:function(a,b){return c.XYZ.xyY(d.fromXYZ(a,b),b)}},xyY:{CMY:function(a,b){return d.fromXYZ(c.xyY.XYZ(a,b),b).toCmy()},CMYK:function(a,b){return d.fromXYZ(c.xyY.XYZ(a,b),b).toCmyk()},HSL:function(a,b){return d.fromXYZ(c.xyY.XYZ(a,b),b).toHsl()},HSV:function(a,b){return d.fromXYZ(c.xyY.XYZ(a,b),b).toHsv()},Lab:function(a,b){return c.Lab.XYZ(c.xyY.XYZ(a,b),b)},LCHab:function(a,b){return c.LCHab.Lab(c.Lab.XYZ(c.xyY.XYZ(a,
b),b),b)},LCHuv:function(a,b){return c.LCHuv.Luv(c.Luv.XYZ(c.xyY.XYZ(a,b),b),b)},Luv:function(a,b){return c.Luv.XYZ(c.xyY.XYZ(a,b),b)},RGB:function(a,b){return d.fromXYZ(c.xyY.XYZ(a,b),b)},XYZ:function(a,b){return c.xyY.XYZ(a,b)}}};this.whitepoint=function(a,b){var b=b||"10",c=0,d=0,f=0;g[b]&&g[b][a]?(c=g[b][a].x,d=g[b][a].y,f=g[b][a].t):console.warn("dojox.color.Colorspace::whitepoint: either the observer or the whitepoint name was not found. ",b,a);return this.convert({x:c,y:d,z:1-c-d,t:f,Y:1},
"xyY","XYZ")};this.tempToWhitepoint=function(a){if(a<4E3)return console.warn("dojox.color.Colorspace::tempToWhitepoint: can't find a white point for temperatures less than 4000K. (Passed ",a,")."),{x:0,y:0};if(a>25E3)return console.warn("dojox.color.Colorspace::tempToWhitepoint: can't find a white point for temperatures greater than 25000K. (Passed ",a,")."),{x:0,y:0};var b=a*a,c=b*a,d=Math.pow(10,9),f=Math.pow(10,6),e=Math.pow(10,3),a=a<=7E3?-4.607*d/c+2.9678*f/b+0.09911*e/a+0.2444063:-2.0064*d/
c+1.9018*f/b+0.24748*e/a+0.23704;return{x:a,y:-3*a*a+2.87*a-0.275}};this.primaries=function(a){var a=dojo.mixin({profile:"sRGB",whitepoint:"D65",observer:"10",adaptor:"Bradford"},a||{}),b=[];i[a.profile]?b=i[a.profile].slice(0):console.warn("dojox.color.Colorspace::primaries: the passed profile was not found.  ","Available profiles include: ",i,".  The profile passed was ",a.profile);b={name:a.profile,gamma:b[0],whitepoint:b[1],xr:b[2],yr:b[3],Yr:b[4],xg:b[5],yg:b[6],Yg:b[7],xb:b[8],yb:b[9],Yb:b[10]};
if(a.whitepoint!=b.whitepoint)var c=this.convert(this.adapt({color:this.convert({x:xr,y:yr,Y:Yr},"xyY","XYZ"),adaptor:a.adaptor,source:b.whitepoint,destination:a.whitepoint}),"XYZ","xyY"),d=this.convert(this.adapt({color:this.convert({x:xg,y:yg,Y:Yg},"xyY","XYZ"),adaptor:a.adaptor,source:b.whitepoint,destination:a.whitepoint}),"XYZ","xyY"),e=this.convert(this.adapt({color:this.convert({x:xb,y:yb,Y:Yb},"xyY","XYZ"),adaptor:a.adaptor,source:b.whitepoint,destination:a.whitepoint}),"XYZ","xyY"),b=dojo.mixin(b,
{xr:c.x,yr:c.y,Yr:c.Y,xg:d.x,yg:d.y,Yg:d.Y,xb:e.x,yb:e.y,Yb:e.Y,whitepoint:a.whitepoint});return dojo.mixin(b,{zr:1-b.xr-b.yr,zg:1-b.xg-b.yg,zb:1-b.xb-b.yb})};this.adapt=function(a){(!a.color||!a.source)&&console.error("dojox.color.Colorspace::adapt: color and source arguments are required. ",a);var a=dojo.mixin({adaptor:"Bradford",destination:"D65"},a),b=this.whitepoint(a.source),c=this.whitepoint(a.destination);if(j[a.adaptor])var d=j[a.adaptor].ma,f=j[a.adaptor].mai;else console.warn("dojox.color.Colorspace::adapt: the passed adaptor '",
a.adaptor,"' was not found.");b=e.multiply([[b.x,b.y,b.z]],d);c=e.multiply([[c.x,c.y,c.z]],d);d=e.multiply(e.multiply(d,[[c[0][0]/b[0][0],0,0],[0,c[0][1]/b[0][1],0],[0,0,c[0][2]/b[0][2]]]),f);a=e.multiply([[a.color.X,a.color.Y,a.color.Z]],d)[0];return{X:a[0],Y:a[1],Z:a[2]}};this.matrix=function(a,b){var c=this.whitepoint(b.whitepoint),d=b.xr/b.yr,f=(1-b.xr-b.yr)/b.yr,g=b.xg/b.yg,h=(1-b.xg-b.yg)/b.yg,i=b.xb/b.yb,j=(1-b.xb-b.yb)/b.yb,l=e.multiply([[c.X,c.Y,c.Z]],e.inverse([[d,1,f],[g,1,h],[i,1,j]])),
c=l[0][0],k=l[0][1],l=l[0][2],d=[[c*d,c*1,c*f],[k*g,k*1,k*h],[l*i,l*1,l*j]];return a=="RGB"?e.inverse(d):d};this.epsilon=function(a){return a||typeof a=="undefined"?0.008856:216/24289};this.kappa=function(a){return a||typeof a=="undefined"?903.3:24389/27};this.convert=function(a,b,c,d){if(k[b]&&k[b][c])return k[b][c](a,d);console.warn("dojox.color.Colorspace::convert: Can't convert ",a," from ",b," to ",c,".")}},dojo.mixin(dojox.color,{fromXYZ:function(d,e){var e=e||{},h=dojox.color.Colorspace.primaries(e),
g=dojox.color.Colorspace.matrix("RGB",h),i=dojox.math.matrix.multiply([[d.X,d.Y,d.Z]],g),j=i[0][0],g=i[0][1],i=i[0][2];h.profile=="sRGB"?(j=j>0.0031308?1.055*Math.pow(j,1/2.4)-0.055:12.92*j,g=g>0.0031308?1.055*Math.pow(g,1/2.4)-0.055:12.92*g,h=i>0.0031308?1.055*Math.pow(i,1/2.4)-0.055:12.92*i):(j=Math.pow(j,1/h.gamma),g=Math.pow(g,1/h.gamma),h=Math.pow(i,1/h.gamma));return new dojox.color.Color({r:Math.floor(j*255),g:Math.floor(g*255),b:Math.floor(h*255)})}}),dojo.extend(dojox.color.Color,{toXYZ:function(d){var d=
d||{},e=dojox.color.Colorspace.primaries(d),d=dojox.color.Colorspace.matrix("XYZ",e),h=this.r/255,g=this.g/255,i=this.b/255;e.profile=="sRGB"?(h=h>0.04045?Math.pow((h+0.055)/1.055,2.4):h/12.92,g=g>0.04045?Math.pow((g+0.055)/1.055,2.4):g/12.92,e=i>0.04045?Math.pow((i+0.055)/1.055,2.4):i/12.92):(h=Math.pow(h,e.gamma),g=Math.pow(g,e.gamma),e=Math.pow(i,e.gamma));d=dojox.math.matrix([[h,g,e]],d);return{X:d[0][0],Y:d[0][1],Z:d[0][2]}}});