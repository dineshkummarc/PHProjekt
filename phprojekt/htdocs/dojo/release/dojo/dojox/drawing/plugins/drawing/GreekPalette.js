/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._hasResource["dojox.drawing.plugins.drawing.GreekPalette"]||(dojo._hasResource["dojox.drawing.plugins.drawing.GreekPalette"]=!0,dojo.provide("dojox.drawing.plugins.drawing.GreekPalette"),dojo.require("dojox.drawing.library.greek"),dojo.require("dijit._Widget"),dojo.require("dijit._Templated"),dojo.require("dijit._PaletteMixin"),dojo.require("dojo.i18n"),dojo.requireLocalization("dojox.editor.plugins","latinEntities",null,"ROOT,ar,ca,cs,da,de,el,es,fi,fr,he,hu,it,ja,kk,ko,nb,nl,pl,pt,pt-pt,ro,ru,sk,sl,sv,th,tr,zh,zh-tw"),
dojo.declare("dojox.drawing.plugins.drawing.GreekPalette",[dijit._Widget,dijit._Templated,dijit._PaletteMixin],{postMixInProperties:function(){var a=dojox.drawing.library.greek,b=0,e;for(e in a)b++;var b=Math.floor(Math.sqrt(b)),g=0,d=[],f=[];for(e in a)g++,f.push(e),g%b===0&&(d.push(f),f=[]);f.length>0&&d.push(f);this._palette=d},onChange:function(a){var b=this._textBlock;dijit.popup.close(this);b.insertText(this._pushChangeTo,a);b._dropMode=!1},onCancel:function(){dijit.popup.close(this);this._textBlock._dropMode=
!1},id:"dropdown",templateString:'<div class="dojoxEntityPalette">\n\t<table>\n\t\t<tbody>\n\t\t\t<tr>\n\t\t\t\t<td>\n\t\t\t\t\t<table class="dijitPaletteTable">\n\t\t\t\t\t\t<tbody dojoAttachPoint="gridNode"></tbody>\n\t\t\t\t   </table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td>\n\t\t\t\t\t<table dojoAttachPoint="previewPane" class="dojoxEntityPalettePreviewTable">\n\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td class="dojoxEntityPalettePreviewDetailEntity">Type: <span class="dojoxEntityPalettePreviewDetail" dojoAttachPoint="previewNode"></span></td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</tbody>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</tbody>\n\t</table>\n</div>',
baseClass:"dojoxEntityPalette",showPreview:!0,dyeClass:"dojox.drawing.plugins.Greeks",paletteClass:"editorLatinEntityPalette",cellClass:"dojoxEntityPaletteCell",buildRendering:function(){this.inherited(arguments);this._preparePalette(this._palette,dojo.i18n.getLocalization("dojox.editor.plugins","latinEntities"));var a=dojo.query(".dojoxEntityPaletteCell",this.gridNode);dojo.forEach(a,function(a){this.connect(a,"onmouseenter","_onCellMouseEnter")},this)},_onCellMouseEnter:function(a){this.showPreview&&
this._displayDetails(a.target)},_onCellClick:function(a){var b=a.type=="click"?a.currentTarget:this._currentFocus,e=this._getDye(b).getValue();this._setCurrent(b);setTimeout(dojo.hitch(this,function(){dijit.focus(b);this._setValueAttr(e,!0)}));dojo.removeClass(b,"dijitPaletteCellHover");dojo.stopEvent(a)},postCreate:function(){this.inherited(arguments);this.showPreview||dojo.style(this.previewNode,"display","none")},_setCurrent:function(a){"_currentFocus"in this&&(dojo.attr(this._currentFocus,"tabIndex",
"-1"),dojo.removeClass(this._currentFocus,"dojoxEntityPaletteCellHover"));if(this._currentFocus=a)dojo.attr(a,"tabIndex",this.tabIndex),dojo.addClass(this._currentFocus,"dojoxEntityPaletteCellHover");this.showPreview&&this._displayDetails(a)},_displayDetails:function(a){(a=this._getDye(a))?this.previewNode.innerHTML=a.getValue():(this.previewNode.innerHTML="",this.descNode.innerHTML="")},_preparePalette:function(a,b){this._cells=[];for(var e=this._blankGif,g=dojo.getObject(this.dyeClass),d=0;d<a.length;d++)for(var f=
dojo.create("tr",{tabIndex:"-1"},this.gridNode),h=0;h<a[d].length;h++){var c=a[d][h];if(c){var i=new g(c),c=dojo.create("td",{"class":this.cellClass,tabIndex:"-1",title:b[c]});i.fillCell(c,e);this.connect(c,"ondijitclick","_onCellClick");this._trackMouseState(c,this.cellClass);dojo.place(c,f);c.index=this._cells.length;this._cells.push({node:c,dye:i})}}this._xDim=a[0].length;this._yDim=a.length},_navigateByArrow:function(a){a=this._currentFocus.index+{38:-this._xDim,40:this._xDim,39:this.isLeftToRight()?
1:-1,37:this.isLeftToRight()?-1:1}[a.keyCode];a<this._cells.length&&a>-1&&this._setCurrent(this._cells[a].node)}}),dojo.declare("dojox.drawing.plugins.Greeks",null,{constructor:function(a){this._alias=a},getValue:function(){return this._alias},fillCell:function(a){a.innerHTML="&"+this._alias+";"}}));